{"version":3,"sources":["Game.js"],"names":["cc","Class","extends","Component","properties","resultSprite","default","type","Sprite","resultLabel","Label","stepLabel","timeLabel","newChessTip","Node","chessPrefab","Prefab","chessList","whiteSpriteFrame","SpriteFrame","blackSpriteFrame","touchChess","visiable","gameState","fiveGroup","fiveGroupScore","audioManager","steps","time","gameOver","stepOrderIndex","restartGame","director","loadScene","toMenu","onLoad","node","active","getComponent","self","y","x","newChess","instantiate","addChild","setPosition","p","tag","on","EventType","TOUCH_END","event","spriteFrame","push","playPlayerPlaceChess","Global","gameType","computerPlay","personalPlay","playComputePlaceChess","b","chess","judgeOver","scheduleOnce","ai","getPositionX","getPositionY","i","length","blackCount","whiteCount","index","highScore","position","spaceFlag","touchX","touchY","parseInt","fiveCount","showResult","j","des","string","playWin","playLose","concat","pauseBgmMusic","giveUp","retract","pop","start","playBgmMusic","callback","schedule","update","dt"],"mappings":"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","file":"Game.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        resultSprite: {\n            default: null,\n            type: cc.Sprite,\n        }, \n        resultLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        stepLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        timeLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        newChessTip: {\n            default: null,\n            type: cc.Node\n        },\n        chessPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        chessList: {\n            default: [],\n            type: [cc.Node],\n        },\n        whiteSpriteFrame: {\n            default: null,\n            type: cc.SpriteFrame,\n        },\n        blackSpriteFrame: {\n            default: null,\n            type: cc.SpriteFrame,\n        },\n        // 当前最新的落子，根据这个落子去判断输赢\n        touchChess: {\n            default: null,\n            type: cc.Node,\n            visiable: false,\n        },\n        gameState: 'white',\n        fiveGroup: [],\n        fiveGroupScore: [],\n        audioManager: cc.Node,\n        steps: 0,\n        time: 0,\n        gameOver: false,\n        stepOrderIndex: []\n    },\n\n    restartGame () {\n        cc.director.loadScene('Game');\n    },\n\n    toMenu () {\n        cc.director.loadScene('Menu');\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.resultSprite.node.active = false;\n        this.newChessTip.node.active = false;\n\n        this.steps = 0;\n        this.time = 0;\n        this.gameOver = false;\n\n        this.audioManager = this.audioManager.getComponent('AudioManager');\n\n        let self = this;\n        // 初始化棋盘\n        for(let y = 0; y < 15; y++) {\n            for(let x = 0; x < 15; x++) {\n                let newChess = cc.instantiate(this.chessPrefab);\n                this.node.addChild(newChess);\n                newChess.setPosition(cc.p(x*40 + 20, y*40 + 20));\n                newChess.tag = y * 15 + x;\n\n                newChess.on(cc.Node.EventType.TOUCH_END, function(event){\n                    if (newChess.getComponent(cc.Sprite).spriteFrame === null){\n                        self.touchChess = newChess;\n                        self.stepOrderIndex.push(newChess.tag);\n                        self.audioManager.playPlayerPlaceChess();\n                        if (Global.gameType === 1){\n                            self.computerPlay(newChess);\n                        } else {\n                            self.personalPlay(newChess);\n                        }\n                    }\n                });\n\n                this.chessList.push(newChess);\n            }\n        }\n\n        // 白棋先在棋盘正中下一子\n        this.chessList[112].getComponent(cc.Sprite).spriteFrame = self.whiteSpriteFrame;\n        if (Global.gameType === 2){\n            this.stepOrderIndex.push(this.chessList[112].tag);\n        }\n        this.timeLabel.node.active = true;\n        this.audioManager.playComputePlaceChess();\n        // 下一步应该下黑棋\n        this.gameState = 'black';\n        // 添加五元数组,就是棋盘中能横竖撇捺能成五的个数，总共572个，找出他们相对于棋盘二维数组的位置索引\n        //横向\n        for(let y=0;y<15;y++){\n            for(let x=0;x<11;x++){\n                this.fiveGroup.push([y*15+x,y*15+x+1,y*15+x+2,y*15+x+3,y*15+x+4]);\n            }  \n        }\n        //纵向\n        for(let x=0;x<15;x++){\n            for(let y=0;y<11;y++){\n                this.fiveGroup.push([y*15+x,(y+1)*15+x,(y+2)*15+x,(y+3)*15+x,(y+4)*15+x]);\n            }\n        }\n        //右上斜向\n        for(let b=-10;b<=10;b++){\n            for(let x=0;x<11;x++){\n                if(b+x<0||b+x>10){\n                    continue;\n                }else{\n                    this.fiveGroup.push([(b+x)*15+x,(b+x+1)*15+x+1,(b+x+2)*15+x+2,(b+x+3)*15+x+3,(b+x+4)*15+x+4]);\n                }\n            }\n        }\n        //右下斜向\n        for(let b=4;b<=24;b++){\n            for(let y=0;y<11;y++){\n                if(b-y<4||b-y>14){\n                    continue;\n                }else{\n                    this.fiveGroup.push([y*15+b-y,(y+1)*15+b-y-1,(y+2)*15+b-y-2,(y+3)*15+b-y-3,(y+4)*15+b-y-4]);\n                }\n            }\n        }\n    },\n\n    // 人机对战\n    computerPlay(chess){\n        if(this.gameState === 'black'){\n            chess.getComponent(cc.Sprite).spriteFrame = this.blackSpriteFrame;\n            // self.newChessTip.node.setPosition(this.getPositionX() - 300, this.getPositionY() - 300);\n            this.judgeOver();\n            if(this.gameState === 'white'){\n                this.scheduleOnce(function(){\n                    this.ai();\n                }, 0.3);\n            }\n        }\n    },\n\n    // 人人对战\n    personalPlay(chess){\n        if(this.gameState === 'black'){\n            chess.getComponent(cc.Sprite).spriteFrame = this.blackSpriteFrame;\n        } else if (this.gameState === 'white'){\n            chess.getComponent(cc.Sprite).spriteFrame = this.whiteSpriteFrame;\n        }\n        this.newChessTip.node.setPosition(chess.getPositionX() - 300, chess.getPositionY() - 300);\n        this.newChessTip.node.active = true;\n        this.steps ++;\n        this.judgeOver();\n    },\n\n    ai () {\n        this.steps++;\n        // 评分，根据五元组里的黑白棋子的不同个数去计算每个点的可能得分\n        for(let i = 0; i < this.fiveGroup.length; i++) {\n            let blackCount = 0; // 五元组中黑棋的个数\n            let whiteCount = 0; // 五元组中白棋的个数\n            for(let index = 0; index < 5; index++) {\n                if ((this.chessList[this.fiveGroup[i][index]].getComponent(cc.Sprite)).spriteFrame == this.blackSpriteFrame) {\n                    blackCount++;\n                } else if ((this.chessList[this.fiveGroup[i][index]].getComponent(cc.Sprite)).spriteFrame == this.whiteSpriteFrame) {\n                    whiteCount++;\n                }\n            }\n\n            if (blackCount + whiteCount == 0) {\n                this.fiveGroupScore[i] = 7;\n            } else if(blackCount > 0 && whiteCount > 0) {\n                this.fiveGroupScore[i] = 0;\n            } else if(blackCount == 0 && whiteCount == 1) {\n                this.fiveGroupScore[i] = 35;\n            } else if(blackCount == 0 && whiteCount == 2) {\n                this.fiveGroupScore[i] = 800;\n            } else if(blackCount == 0 && whiteCount == 3) {\n                this.fiveGroupScore[i] = 15000;\n            } else if(blackCount == 0 && whiteCount == 4) {\n                this.fiveGroupScore[i] = 800000;\n            } else if(whiteCount == 0 && blackCount == 1) {\n                this.fiveGroupScore[i] = 15;\n            } else if(whiteCount == 0 && blackCount == 2) {\n                this.fiveGroupScore[i] = 400;\n            } else if(whiteCount == 0 && blackCount == 3) {\n                this.fiveGroupScore[i] = 1800;\n            } else if(whiteCount == 0 && blackCount == 4) {\n                this.fiveGroupScore[i] = 100000;\n            }\n        }\n        // 找出最高分的五元组\n        let highScore = 0;\n        let position = 0;\n        for(let i = 0; i < this.fiveGroupScore.length; i++) {\n            if(this.fiveGroupScore[i] > highScore) {\n                highScore = this.fiveGroupScore[i];\n                position = i;\n            }\n        }\n        // 在最高分的五元组里的可以下子的位置找到最优的下子位置\n        // 每次找能下子的最后一个位置\n        let spaceFlag = false;\n        let index = 0;\n        for(let i = 0; i < 5; i++) {\n            if(!spaceFlag) {\n                if(this.chessList[this.fiveGroup[position][i]].getComponent(cc.Sprite).spriteFrame == null) {\n                    index = i;\n                } else {\n                    spaceFlag = true;\n                }\n            }\n            if(spaceFlag && this.chessList[this.fiveGroup[position][i]].getComponent(cc.Sprite).spriteFrame == null) {\n                index = i;\n                break;\n            }\n        }\n        // 在最优位置下子\n        this.chessList[this.fiveGroup[position][index]].getComponent(cc.Sprite).spriteFrame = this.whiteSpriteFrame;\n        this.stepOrderIndex.push(this.fiveGroup[position][index]);\n        this.newChessTip.node.setPosition(this.chessList[this.fiveGroup[position][index]].getPositionX() - 300, this.chessList[this.fiveGroup[position][index]].getPositionY() - 300);\n        this.newChessTip.node.active = true;\n        this.audioManager.playComputePlaceChess();\n        this.touchChess = this.chessList[this.fiveGroup[position][index]];\n        this.judgeOver();\n    },\n\n    judgeOver () {\n        let touchX = this.touchChess.tag % 15;\n        let touchY = parseInt(this.touchChess.tag / 15);\n        let fiveCount = 0;\n        // 横向判断\n        for(let i = touchX - 4; i <= touchX + 4; i++) {\n            if(i < 0 || i > 14) {\n                continue;\n            } else {\n                if((this.chessList[touchY * 15 + i].getComponent(cc.Sprite)).spriteFrame === this.touchChess.getComponent(cc.Sprite).spriteFrame) {\n                    fiveCount++;\n                    if(fiveCount == 5) {\n                        this.showResult();\n                        return;\n                    }\n                } else {\n                    fiveCount = 0;\n                }\n            }\n        }\n        // 竖向判断\n        for(let i = touchY - 4; i <= touchY + 4; i++) {\n            if(i < 0 || i > 14) {\n                continue;\n            } else {\n                if((this.chessList[i * 15 + touchX].getComponent(cc.Sprite)).spriteFrame === this.touchChess.getComponent(cc.Sprite).spriteFrame ) {\n                    fiveCount++;\n                    if(fiveCount == 5) {\n                        this.showResult();\n                        return;\n                    }\n                } else {\n                    fiveCount = 0;\n                }\n            }\n        }\n        // 撇向判断\n        for(let i = touchX - 4, j = touchY - 4; (i <= touchX + 4) && (j <= touchY + 4); i++, j++) {\n            if (i < 0 || j < 0 || i > 14 || j > 14) {\n                continue;\n            } else {\n                if((this.chessList[j * 15 + i].getComponent(cc.Sprite)).spriteFrame === this.touchChess.getComponent(cc.Sprite).spriteFrame) {\n                    fiveCount++;\n                    if(fiveCount == 5) {\n                        this.showResult();\n                        return;\n                    }\n                } else {\n                    fiveCount = 0;\n                }\n            }\n        }\n        \n        // 捺向判断\n        for(let i = touchX - 4, j = touchY + 4; (i <= touchX + 4) && (j <= touchY - 4); i++, j++) {\n            if (i < 0 || j < 0 || i > 14 || j > 14) {\n                continue;\n            } else {\n                if((this.chessList[j * 15 + i].getComponent(cc.Sprite)).spriteFrame === this.touchChess.getComponent(cc.Sprite).spriteFrame) {\n                    fiveCount++;\n                    if(fiveCount == 5) {\n                        this.showResult();\n                        return;\n                    }\n                } else {\n                    fiveCount = 0;\n                }\n            }\n        }\n        \n        // 没有输赢则交换下子顺序\n        if(this.gameState === 'black') {\n            this.gameState = 'white';\n        } else {\n            this.gameState = 'black';\n        }\n    },\n\n    showResult () {\n        this.gameOver = true;\n        let des = \"\";\n        if (Global.gameType === 1){\n            if(this.gameState === 'black') {\n                this.resultLabel.string = \"你赢了\";\n                this.audioManager.playWin();\n            } else {\n                this.resultLabel.string = \"你输了\";\n                this.audioManager.playLose();\n            }\n            this.stepLabel.string = \"走了\".concat(this.steps).concat(\"步\");\n        } else {\n            this.resultLabel.string = this.gameState + \"赢了\";\n            this.audioManager.playWin();\n        }\n\n        this.audioManager.pauseBgmMusic();\n        this.resultSprite.node.active = true;\n        this.gameState = 'over';\n    },\n\n    giveUp () {\n        if (Global.gameType === 1){\n            this.gameState = 'white';\n        } else {\n            if (this.gameState === 'white'){\n                this.gameState = 'black';\n            } else {\n                this.gameState = 'white';\n            }\n        }\n        this.showResult();\n    },\n\n    // 悔棋\n    retract () {\n        if(this.stepOrderIndex.length != 0) {\n            this.steps--;\n            this.chessList[this.stepOrderIndex.pop()].getComponent(cc.Sprite).spriteFrame = null;\n            if (Global.gameType === 1){\n                this.chessList[this.stepOrderIndex.pop()].getComponent(cc.Sprite).spriteFrame = null;\n            }\n            if(this.stepOrderIndex.length != 0) {\n                this.newChessTip.node.setPosition(this.chessList[this.stepOrderIndex[this.stepOrderIndex.length - 1]].getPositionX() - 300, \n                    this.chessList[this.stepOrderIndex[this.stepOrderIndex.length - 1]].getPositionY() - 300);\n            } else {\n                this.newChessTip.node.setPosition(0, 0);\n                this.newChessTip.node.active = false;\n            }\n\n            if (Global.gameType === 2){\n                if (this.gameState === 'white'){\n                    this.gameState = 'black';\n                } else {\n                    this.gameState = 'white';\n                }\n            }\n        }\n    },\n\n    start () {\n        this.audioManager.playBgmMusic();\n        this.callback = function () {\n            this.time++;\n        }\n        this.schedule(this.callback, 1);\n    },\n\n    update (dt) {\n        if(!this.gameOver) {\n            this.timeLabel.string = \"时间：\".concat(this.time).concat(\"秒\");\n        }\n    },\n});\n"]}