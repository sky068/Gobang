{"version":3,"sources":["Game.js"],"names":["cc","Class","extends","Component","properties","resultSprite","default","type","Sprite","resultLabel","Label","stepLabel","timeLabel","newChessTip","Node","chessPrefab","Prefab","chessList","whiteSpriteFrame","SpriteFrame","blackSpriteFrame","touchChess","visiable","gameState","fiveGroup","fiveGroupScore","audioManager","steps","time","gameOver","stepOrderIndex","restartGame","director","loadScene","toMenu","onLoad","node","active","getComponent","self","y","x","newChess","instantiate","addChild","setPosition","p","tag","on","EventType","TOUCH_END","event","spriteFrame","push","playPlayerPlaceChess","judgeOver","scheduleOnce","ai","playComputePlaceChess","b","i","length","blackCount","whiteCount","index","highScore","position","spaceFlag","getPositionX","getPositionY","touchX","touchY","parseInt","fiveCount","showResult","j","string","playWin","playLose","concat","pauseBgmMusic","giveUp","retract","pop","start","playBgmMusic","callback","schedule","update","dt"],"mappings":"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","file":"Game.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        resultSprite: {\n            default: null,\n            type: cc.Sprite,\n        }, \n        resultLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        stepLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        timeLabel: {\n            default: null,\n            type: cc.Label,\n        },\n        newChessTip: {\n            default: null,\n            type: cc.Node\n        },\n        chessPrefab: {\n            default: null,\n            type: cc.Prefab,\n        },\n        chessList: {\n            default: [],\n            type: [cc.Node],\n        },\n        whiteSpriteFrame: {\n            default: null,\n            type: cc.SpriteFrame,\n        },\n        blackSpriteFrame: {\n            default: null,\n            type: cc.SpriteFrame,\n        },\n        // 当前最新的落子，根据这个落子去判断输赢\n        touchChess: {\n            default: null,\n            type: cc.Node,\n            visiable: false,\n        },\n        gameState: 'white',\n        fiveGroup: [],\n        fiveGroupScore: [],\n        audioManager: cc.Node,\n        steps: 0,\n        time: 0,\n        gameOver: false,\n        stepOrderIndex: []\n    },\n\n    restartGame () {\n        cc.director.loadScene('Game');\n    },\n\n    toMenu () {\n        cc.director.loadScene('Menu');\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.resultSprite.node.active = false;\n        this.newChessTip.node.active = false;\n\n        this.steps = 0;\n        this.time = 0;\n        this.gameOver = false;\n\n        this.audioManager = this.audioManager.getComponent('AudioManager');\n\n        var self = this;\n        // 初始化棋盘\n        for(var y = 0; y < 15; y++) {\n            for(var x = 0; x < 15; x++) {\n                var newChess = cc.instantiate(this.chessPrefab);\n                this.node.addChild(newChess);\n                newChess.setPosition(cc.p(x*40 + 20, y*40 + 20));\n                newChess.tag = y * 15 + x;\n                newChess.on(cc.Node.EventType.TOUCH_END, function(event){\n                    self.touchChess = this;\n                    if(self.gameState === 'black' && this.getComponent(cc.Sprite).spriteFrame === null){\n                        self.stepOrderIndex.push(this.tag);\n                        this.getComponent(cc.Sprite).spriteFrame = self.blackSpriteFrame;\n                        // self.newChessTip.node.setPosition(this.getPositionX() - 300, this.getPositionY() - 300);\n                        self.audioManager.playPlayerPlaceChess();\n                        self.judgeOver();\n                        if(self.gameState === 'white'){\n                            self.scheduleOnce(function(){\n                                self.ai();\n                            }, 0.3);\n                        }\n                    }\n                });\n\n                this.chessList.push(newChess);\n            }\n        }\n\n        // 白棋先在棋盘正中下一子\n        this.chessList[112].getComponent(cc.Sprite).spriteFrame = self.whiteSpriteFrame;\n        this.timeLabel.node.active = true;\n        this.audioManager.playComputePlaceChess();\n        // 下一步应该下黑棋\n        this.gameState = 'black';\n        // 添加五元数组,就是棋盘中能横竖撇捺能成五的个数，总共572个，找出他们相对于棋盘二维数组的位置索引\n        //横向\n        for(var y=0;y<15;y++){\n            for(var x=0;x<11;x++){\n                this.fiveGroup.push([y*15+x,y*15+x+1,y*15+x+2,y*15+x+3,y*15+x+4]);\n            }  \n        }\n        //纵向\n        for(var x=0;x<15;x++){\n            for(var y=0;y<11;y++){\n                this.fiveGroup.push([y*15+x,(y+1)*15+x,(y+2)*15+x,(y+3)*15+x,(y+4)*15+x]);\n            }\n        }\n        //右上斜向\n        for(var b=-10;b<=10;b++){\n            for(var x=0;x<11;x++){\n                if(b+x<0||b+x>10){\n                    continue;\n                }else{\n                    this.fiveGroup.push([(b+x)*15+x,(b+x+1)*15+x+1,(b+x+2)*15+x+2,(b+x+3)*15+x+3,(b+x+4)*15+x+4]);\n                }\n            }\n        }\n        //右下斜向\n        for(var b=4;b<=24;b++){\n            for(var y=0;y<11;y++){\n                if(b-y<4||b-y>14){\n                    continue;\n                }else{\n                    this.fiveGroup.push([y*15+b-y,(y+1)*15+b-y-1,(y+2)*15+b-y-2,(y+3)*15+b-y-3,(y+4)*15+b-y-4]);\n                }\n            }\n        }\n    },\n\n    ai () {\n        this.steps++;\n        // 评分，根据五元组里的黑白棋子的不同个数去计算每个点的可能得分\n        for(var i = 0; i < this.fiveGroup.length; i++) {\n            var blackCount = 0; // 五元组中黑棋的个数\n            var whiteCount = 0; // 五元组中白棋的个数\n            for(var index = 0; index < 5; index++) {\n                if ((this.chessList[this.fiveGroup[i][index]].getComponent(cc.Sprite)).spriteFrame == this.blackSpriteFrame) {\n                    blackCount++;\n                } else if ((this.chessList[this.fiveGroup[i][index]].getComponent(cc.Sprite)).spriteFrame == this.whiteSpriteFrame) {\n                    whiteCount++;\n                }\n            }\n\n            if (blackCount + whiteCount == 0) {\n                this.fiveGroupScore[i] = 7;\n            } else if(blackCount > 0 && whiteCount > 0) {\n                this.fiveGroupScore[i] = 0;\n            } else if(blackCount == 0 && whiteCount == 1) {\n                this.fiveGroupScore[i] = 35;\n            } else if(blackCount == 0 && whiteCount == 2) {\n                this.fiveGroupScore[i] = 800;\n            } else if(blackCount == 0 && whiteCount == 3) {\n                this.fiveGroupScore[i] = 15000;\n            } else if(blackCount == 0 && whiteCount == 4) {\n                this.fiveGroupScore[i] = 800000;\n            } else if(whiteCount == 0 && blackCount == 1) {\n                this.fiveGroupScore[i] = 15;\n            } else if(whiteCount == 0 && blackCount == 2) {\n                this.fiveGroupScore[i] = 400;\n            } else if(whiteCount == 0 && blackCount == 3) {\n                this.fiveGroupScore[i] = 1800;\n            } else if(whiteCount == 0 && blackCount == 4) {\n                this.fiveGroupScore[i] = 100000;\n            }\n        }\n        // 找出最高分的五元组\n        var highScore = 0;\n        var position = 0;\n        for(var i = 0; i < this.fiveGroupScore.length; i++) {\n            if(this.fiveGroupScore[i] > highScore) {\n                highScore = this.fiveGroupScore[i];\n                position = i;\n            }\n        }\n        // 在最高分的五元组里的可以下子的位置找到最优的下子位置\n        // 每次找能下子的最后一个位置\n        var spaceFlag = false;\n        var index = 0;\n        for(var i = 0; i < 5; i++) {\n            if(!spaceFlag) {\n                if(this.chessList[this.fiveGroup[position][i]].getComponent(cc.Sprite).spriteFrame == null) {\n                    index = i;\n                } else {\n                    spaceFlag = true;\n                }\n            }\n            if(spaceFlag && this.chessList[this.fiveGroup[position][i]].getComponent(cc.Sprite).spriteFrame == null) {\n                index = i;\n                break;\n            }\n        }\n        // 在最优位置下子\n        this.chessList[this.fiveGroup[position][index]].getComponent(cc.Sprite).spriteFrame = this.whiteSpriteFrame;\n        this.stepOrderIndex.push(this.fiveGroup[position][index]);\n        this.newChessTip.node.setPosition(this.chessList[this.fiveGroup[position][index]].getPositionX() - 300, this.chessList[this.fiveGroup[position][index]].getPositionY() - 300);\n        this.newChessTip.node.active = true;\n        this.audioManager.playComputePlaceChess();\n        this.touchChess = this.chessList[this.fiveGroup[position][index]];\n        this.judgeOver();\n    },\n\n    judgeOver () {\n        var touchX = this.touchChess.tag % 15;\n        var touchY = parseInt(this.touchChess.tag / 15);\n        var fiveCount = 0;\n        // 横向判断\n        for(var i = touchX - 4; i <= touchX + 4; i++) {\n            if(i < 0 || i > 14) {\n                continue;\n            } else {\n                if((this.chessList[touchY * 15 + i].getComponent(cc.Sprite)).spriteFrame === this.touchChess.getComponent(cc.Sprite).spriteFrame) {\n                    fiveCount++;\n                    if(fiveCount == 5) {\n                        this.showResult();\n                        return;\n                    }\n                } else {\n                    fiveCount = 0;\n                }\n            }\n        }\n        // 竖向判断\n        for(var i = touchY - 4; i <= touchY + 4; i++) {\n            if(i < 0 || i > 14) {\n                continue;\n            } else {\n                if((this.chessList[i * 15 + touchX].getComponent(cc.Sprite)).spriteFrame === this.touchChess.getComponent(cc.Sprite).spriteFrame ) {\n                    fiveCount++;\n                    if(fiveCount == 5) {\n                        this.showResult();\n                        return;\n                    }\n                } else {\n                    fiveCount = 0;\n                }\n            }\n        }\n        // 撇向判断\n        for(var i = touchX - 4, j = touchY - 4; (i <= touchX + 4) && (j <= touchY + 4); i++, j++) {\n            if (i < 0 || j < 0 || i > 14 || j > 14) {\n                continue;\n            } else {\n                if((this.chessList[j * 15 + i].getComponent(cc.Sprite)).spriteFrame === this.touchChess.getComponent(cc.Sprite).spriteFrame) {\n                    fiveCount++;\n                    if(fiveCount == 5) {\n                        this.showResult();\n                        return;\n                    }\n                } else {\n                    fiveCount = 0;\n                }\n            }\n        }\n        \n        // 捺向判断\n        for(var i = touchX - 4, j = touchY + 4; (i <= touchX + 4) && (j <= touchY - 4); i++, j++) {\n            if (i < 0 || j < 0 || i > 14 || j > 14) {\n                continue;\n            } else {\n                if((this.chessList[j * 15 + i].getComponent(cc.Sprite)).spriteFrame === this.touchChess.getComponent(cc.Sprite).spriteFrame) {\n                    fiveCount++;\n                    if(fiveCount == 5) {\n                        this.showResult();\n                        return;\n                    }\n                } else {\n                    fiveCount = 0;\n                }\n            }\n        }\n        \n        // 没有输赢则交换下子顺序\n        if(this.gameState === 'black') {\n            this.gameState = 'white';\n        } else {\n            this.gameState = 'black';\n        }\n    },\n\n    showResult () {\n        this.gameOver = true;\n        if(this.gameState === 'black') {\n            this.resultLabel.string = \"你赢了\";\n            this.audioManager.playWin();\n        } else {\n            this.resultLabel.string = \"你输了\";\n            this.audioManager.playLose();\n        }\n        this.stepLabel.string = \"走了\".concat(this.steps).concat(\"步\");\n        this.audioManager.pauseBgmMusic();\n        this.resultSprite.node.active = true;\n        this.gameState = 'over';\n    },\n\n    giveUp () {\n        this.gameState = 'white';\n        this.showResult();\n    },\n\n    retract () {\n        if(this.stepOrderIndex.length != 0) {\n            this.steps--;\n            this.chessList[this.stepOrderIndex.pop()].getComponent(cc.Sprite).spriteFrame = null;\n            this.chessList[this.stepOrderIndex.pop()].getComponent(cc.Sprite).spriteFrame = null;\n            if(this.stepOrderIndex.length != 0) {\n                this.newChessTip.node.setPosition(this.chessList[this.stepOrderIndex[this.stepOrderIndex.length - 1]].getPositionX() - 300, \n                    this.chessList[this.stepOrderIndex[this.stepOrderIndex.length - 1]].getPositionY() - 300);\n            } else {\n                this.newChessTip.node.setPosition(0, 0);\n            }\n        }\n    },\n\n    start () {\n        this.audioManager.playBgmMusic();\n        this.callback = function () {\n            this.time++;\n        }\n        this.schedule(this.callback, 1);\n    },\n\n    update (dt) {\n        if(!this.gameOver) {\n            this.timeLabel.string = \"时间：\".concat(this.time).concat(\"秒\");\n        }\n    },\n});\n"]}